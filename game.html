<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=no">
    <title>ğŸŒ¸ èŠ±æ¼¾è¿è¿çœ‹ Â· è®°å¿†ç”œå¿ƒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Helvetica Neue', 'Apple Color Emoji', 'Segoe UI Emoji', sans-serif;
        }

        body {
            background: linear-gradient(145deg, #ffdde1 0%, #f9c9d7 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px;
            margin: 0;
            position: relative;
        }

        /* æ¼‚æµ®å°è£…é¥° â€”â€” å°‘å¥³å¿ƒæ»¡æ»¡ */
        body::before {
            content: "ğŸŒ¸ğŸŒ¸ğŸŒ¸";
            position: absolute;
            top: 10px;
            left: 20px;
            font-size: 28px;
            opacity: 0.2;
            white-space: nowrap;
            transform: rotate(-5deg);
            pointer-events: none;
        }

        body::after {
            content: "âœ¨âœ¨âœ¨";
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 32px;
            opacity: 0.2;
            transform: rotate(8deg);
            pointer-events: none;
        }

        .game-container {
            max-width: 700px;
            width: 100%;
            background: rgba(255, 245, 240, 0.7);
            backdrop-filter: blur(8px);
            border-radius: 48px 48px 32px 32px;
            padding: 24px 20px 30px;
            box-shadow: 0 20px 30px rgba(244, 154, 194, 0.25);
            border: 2px solid #fff9;
            position: relative;
            z-index: 10;
        }

        /* å¯çˆ±å¤´éƒ¨ */
        .game-header {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            padding: 0 10px;
        }

        .title-area {
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #ac4f7c;
            text-shadow: 3px 3px 0 #ffe2ec;
            letter-spacing: 2px;
        }

        .title span {
            font-size: 2rem;
        }

        .stats {
            display: flex;
            gap: 18px;
            background: #ffeaef;
            padding: 10px 18px;
            border-radius: 40px;
            box-shadow: inset 0 2px 6px #ffccd5, 0 6px 0 #d48c9c;
            border: 1px solid #ffbbc5;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            color: #7a3e4f;
        }

        .stat-icon {
            font-size: 1.4rem;
        }

        .reset-btn {
            background: #ffb6c1;
            border: none;
            border-radius: 50px;
            padding: 10px 24px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #5d2e3b;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 8px 0 #b3747e, 0 10px 20px rgba(200, 100, 120, 0.3);
            transition: all 0.06s ease;
            border: 2px solid #fff9;
            cursor: pointer;
        }

        .reset-btn:active {
            transform: translateY(8px);
            box-shadow: 0 2px 0 #b3747e, 0 10px 20px rgba(200, 100, 120, 0.2);
        }

        /* æ¸¸æˆæ¿ â€”â€” 4x4 æ¸©æŸ”ç½‘æ ¼ */
        .board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 14px;
            justify-content: center;
            margin-bottom: 25px;
            padding: 8px;
        }

        /* å¡ç‰‡æ ·å¼ â€”â€” è½¯èŒç¿»ç³–æ„Ÿ */
        .card {
            aspect-ratio: 1 / 1;
            background: #fffbf0;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.8rem;
            box-shadow: 0 12px 0 #d496a6, 0 10px 20px rgba(160, 80, 100, 0.2);
            border: 3px solid #ffe9f0;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.22, 1, 0.36, 1);
            transform: scale(1);
            user-select: none;
            color: #5c3e45;
            background: linear-gradient(145deg, #fff9fb, #ffeef2);
            position: relative;
        }

        /* å¡ç‰‡èƒŒé¢ç»Ÿä¸€å°èŠ±èŠ±ï¼Œæ­£é¢å¯¹åº”ä¸åŒemoji */
        .card:active {
            transform: scale(0.94);
            box-shadow: 0 6px 0 #d496a6, 0 10px 20px rgba(160, 80, 100, 0.2);
        }

        /* å·²é…å¯¹å¡ç‰‡ â€”â€” æ¸©æŸ”å…‰æ™•ï¼Œä¸å¯ç‚¹å‡» */
        .card.matched {
            box-shadow: 0 0 0 3px #ffe5b4, 0 8px 0 #b8838f, 0 10px 20px rgba(120, 70, 80, 0.15);
            background: #fff1e7;
            border: 3px solid #ffe0b5;
            cursor: default;
            pointer-events: none;
            opacity: 0.9;
            transform: translateY(4px);
            filter: drop-shadow(0 4px 6px #ffcaca);
        }

        /* ç¿»è½¬çŠ¶æ€ï¼ˆä¸´æ—¶ç¿»å¼€ï¼‰ */
        .card.flipped {
            background: #fff0f5;
            border: 3px solid #ffb7c5;
            box-shadow: 0 6px 0 #d496a6, 0 10px 20px rgba(200, 120, 140, 0.25);
        }

        /* èƒœåˆ©æ¶ˆæ¯å°ç”œç‚¹ */
        .message-area {
            text-align: center;
            padding: 10px 0;
            font-size: 1.5rem;
            font-weight: 600;
            color: #9f4d6a;
            background: #ffecf0cc;
            border-radius: 60px;
            margin: 10px 20px 0;
            border: 2px dashed #ff90a5;
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-height: 60px;
        }

        .footer-whisper {
            color: #ba7a8a;
            margin-top: 10px;
            font-size: 0.9rem;
            text-align: center;
            opacity: 0.9;
        }

        /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
        @media (max-width: 480px) {
            .game-container {
                padding: 16px 12px;
                border-radius: 36px;
            }
            .card {
                font-size: 2.2rem;
            }
            .title {
                font-size: 1.5rem;
            }
            .stats {
                padding: 6px 14px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- å¤´éƒ¨ï¼šæ ‡é¢˜ã€æ­¥æ•°/é…å¯¹ã€é‡ç½®æŒ‰é’® -->
        <div class="game-header">
            <div class="title-area">
                <div class="title">
                    <span>ğŸŒ¸</span> èŠ±æ¼¾è®°
                </div>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-icon">ğŸ‘£</span>
                    <span id="move-counter">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">ğŸ§</span>
                    <span id="pair-counter">0/8</span>
                </div>
            </div>
            <button class="reset-btn" id="reset-button">
                <span>ğŸ”„</span> æ–°ä¸€å±€
            </button>
        </div>

        <!-- æ¸¸æˆå¡ç‰‡åŒºåŸŸ 4x4 ç”±JSåŠ¨æ€ç”Ÿæˆ -->
        <div class="board" id="game-board"></div>

        <!-- èŒèŒæ¶ˆæ¯åŒºï¼šèƒœåˆ©/æç¤º -->
        <div class="message-area" id="message-banner">
            ğŸ’• ç¿»å¼€å¡ç‰‡ï¼Œé…å¯¹æˆåŠŸå§ï½
        </div>
        <div class="footer-whisper">
            â€”â€” ç»™ç”œç”œçš„ä½  Â· æ…¢æ…¢ç© â€”â€”
        </div>
    </div>

    <script>
        (function(){
            "use strict";

            // ---------- å°‘å¥³å¿ƒä¸»é¢˜é…ç½® ----------
            // èƒŒé¢å›¾æ¡ˆï¼šæ‰€æœ‰æœªç¿»å¼€/æœªåŒ¹é…çš„å¡ç‰‡ç»Ÿä¸€æ˜¾ç¤ºå°é›èŠğŸŒ¼ï¼ˆå¯æ¢æˆğŸŒ¸ä½†ä¸ºäº†åŒºåˆ†æ­£é¢ä½¿ç”¨ğŸŒ¼ï¼‰
            const CARD_BACK = 'ğŸŒ¼';
            
            // æ­£é¢8å¯¹å¯çˆ±å›¾æ¡ˆ â€”â€” è½¯èŒ+èŠ±+çˆ±å¿ƒï¼Œå®Œå…¨å¥³ç”Ÿå‘
            const PAIR_EMOJIS = ['ğŸ±', 'ğŸ¶', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼', 'ğŸŒ¸', 'â¤ï¸'];
            const TOTAL_PAIRS = PAIR_EMOJIS.length;     // 8å¯¹
            const TOTAL_CARDS = TOTAL_PAIRS * 2;        // 16å¼ ï¼Œ4x4

            // ---------- å…¨å±€å˜é‡ ----------
            let boardEl = document.getElementById('game-board');
            let moveSpan = document.getElementById('move-counter');
            let pairSpan = document.getElementById('pair-counter');
            let messageEl = document.getElementById('message-banner');

            let lockBoard = false;              // æ˜¯å¦é”å®šï¼ˆæ¯”å¦‚ç­‰å¾…ç¿»è½¬å›å»ï¼‰
            let flippedCards = [];              // å½“å‰ç¿»å¼€ï¼ˆä¸´æ—¶ï¼‰çš„å¡ç‰‡å…ƒç´ æ•°ç»„ï¼Œæœ€å¤š2ä¸ª
            let moves = 0;                     // æ­¥æ•°
            let matchedPairs = 0;              // å·²æˆåŠŸé…å¯¹çš„æ•°é‡
            let flipTimeout = null;            // ä¸åŒ¹é…æ—¶å»¶è¿Ÿç¿»è½¬çš„å®šæ—¶å™¨

            // ---------- è¾…åŠ©å‡½æ•° ----------
            // æ´—ç‰Œç®—æ³• (Fisherâ€“Yates)
            function shuffleArray(arr) {
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            }

            // ç”Ÿæˆ16å¼ å¡ç‰‡çš„é…å¯¹ID (0,0,1,1,2,2...7,7) å¹¶æ‰“ä¹±
            function generateShuffledPairs() {
                let pairs = [];
                for (let i = 0; i < TOTAL_PAIRS; i++) {
                    pairs.push(i, i);   // æ¯å¯¹å‡ºç°ä¸¤æ¬¡
                }
                return shuffleArray(pairs);
            }

            // æ›´æ–°UIä¸Šçš„æ­¥æ•° & é…å¯¹è¿›åº¦
            function updateStats() {
                moveSpan.textContent = moves;
                pairSpan.textContent = `${matchedPairs}/${TOTAL_PAIRS}`;
            }

            // æ˜¾ç¤ºèƒœåˆ©æ¶ˆæ¯ â€”â€” ç”œåº¦æ»¡åˆ†
            function showWinMessage() {
                messageEl.innerHTML = 'ğŸ‰âœ¨ å¤ªå‰å®³å•¦ï¼å…¨éƒ¨é…å¯¹æˆåŠŸï¼âœ¨ğŸ‰ <span style="font-size:1.8rem;">ğŸ°ğŸŒ¸</span>';
            }

            // é‡ç½®èƒœåˆ©/æ™®é€šæ¶ˆæ¯
            function resetMessage() {
                messageEl.innerHTML = 'ğŸ’• ç¿»å¼€å¡ç‰‡ï¼Œé…å¯¹æˆåŠŸå§ï½';
            }

            // æ¸…é™¤å®šæ—¶å™¨ï¼Œé¿å…å†²çª
            function clearFlipTimeout() {
                if (flipTimeout) {
                    clearTimeout(flipTimeout);
                    flipTimeout = null;
                }
            }

            // ---------- å¡ç‰‡åŒ¹é…æ ¸å¿ƒé€»è¾‘ ----------
            // æ£€æŸ¥å½“å‰ç¿»å¼€çš„ä¸¤å¼ å¡ç‰‡æ˜¯å¦é…å¯¹
            function checkMatch() {
                // ç¡®ä¿æœ‰ä¸¤å¼ å¡ç‰‡
                if (flippedCards.length !== 2) return;

                const card1 = flippedCards[0];
                const card2 = flippedCards[1];
                const pair1 = card1.dataset.pairid;
                const pair2 = card2.dataset.pairid;

                // é˜²æ­¢æ„å¤–ï¼šå¦‚æœæ˜¯åŒä¸€å¼ å¡ç‰‡ï¼ˆå‡ ä¹ä¸å¯èƒ½ï¼Œä½†é˜²å¾¡ï¼‰
                if (card1 === card2) {
                    flippedCards = [];
                    return;
                }

                // ---------- é…å¯¹æˆåŠŸ â™¥ ----------
                if (pair1 === pair2) {
                    // æ ‡è®°ä¸¤å¼ å¡ç‰‡ä¸ºå·²åŒ¹é…
                    card1.classList.add('matched');
                    card2.classList.add('matched');
                    card1.classList.remove('flipped'); // ç§»é™¤ç¿»è½¬çŠ¶æ€ï¼Œæ”¹ç”¨matchedæ ·å¼
                    card2.classList.remove('flipped');
                    card1.dataset.matched = 'true';
                    card2.dataset.matched = 'true';

                    // é…å¯¹è®¡æ•°+1
                    matchedPairs++;
                    updateStats();

                    // æ¸…ç©ºæœ¬æ¬¡ç¿»å¼€çš„æ•°ç»„
                    flippedCards = [];

                    // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨é…å¯¹å®Œæ¯• (èƒœåˆ©!)
                    if (matchedPairs === TOTAL_PAIRS) {
                        showWinMessage();
                    }
                } 
                // ---------- é…å¯¹å¤±è´¥ï¼šçŸ­æš‚å±•ç¤ºåç¿»å›èƒŒé¢ ----------
                else {
                    lockBoard = true;   // é”å®šï¼Œä¸å¯ç‚¹å‡»æ–°å¡ç‰‡

                    // è®¾ç½®å®šæ—¶å™¨ï¼Œ0.7ç§’åç¿»å›ï¼ˆæ¸©æŸ”å»¶è¿Ÿï¼‰
                    flipTimeout = setTimeout(function() {
                        // ç¿»å›è¿™ä¸¤å¼ å¡ç‰‡ï¼šå†…å®¹æ”¹ä¸ºèƒŒé¢å°èŠ±ï¼Œç§»é™¤ç¿»è½¬ç±»
                        card1.textContent = CARD_BACK;
                        card2.textContent = CARD_BACK;
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');

                        // æ¸…ç©ºç¿»è½¬æ•°ç»„å¹¶è§£é”
                        flippedCards = [];
                        lockBoard = false;

                        // æ¸…é™¤å®šæ—¶å™¨æ ‡è®°
                        flipTimeout = null;
                    }, 700);
                }

                // æ— è®ºæˆåŠŸå¤±è´¥ï¼Œå·²ç»æ£€æŸ¥å®Œä¸€å¯¹ï¼Œæ­¤æ—¶ç¿»è½¬æ•°ç»„ä¼šåœ¨æˆåŠŸæ—¶æ¸…ç©ºï¼Œå¤±è´¥æ—¶å»¶æ—¶æ¸…ç©ºï¼›æš‚æ—¶ä¸æ“ä½œ
            }

            // ---------- å¤„ç†å¡ç‰‡ç‚¹å‡»ï¼ˆç¿»ç‰Œï¼‰----------
            function onCardClick(e) {
                const card = e.currentTarget;

                // æ¡ä»¶åˆ¤æ–­ï¼šä¸å¯ç‚¹å‡»çš„æƒ…å†µ
                // 1. å…¨å±€é”å®šï¼ˆæ­£åœ¨ç­‰å¾…ç¿»è½¬è¿”å›ï¼‰
                if (lockBoard) return;
                // 2. å¡ç‰‡å·²æ°¸ä¹…åŒ¹é…ï¼ˆæœ‰matchedç±»æˆ–è€…datasetæ ‡è®°ï¼‰
                if (card.classList.contains('matched') || card.dataset.matched === 'true') return;
                // 3. å¡ç‰‡å·²ç»å¤„äºç¿»å¼€çŠ¶æ€ï¼ˆé˜²æ­¢é‡å¤ç‚¹åŒä¸€å¼ ï¼‰
                if (card.classList.contains('flipped')) return;
                // 4. å·²ç»ç¿»å¼€ä¸¤å¼ å¡ç‰‡ä¸”è¿˜æœªå¤„ç†ï¼ˆå®é™…ä¸Šé”çŠ¶æ€ä¼šæ‹¦ä½ï¼Œä½†å¤šä¸€å±‚é˜²å¾¡ï¼‰
                if (flippedCards.length >= 2) return;

                // ---------- æœ‰æ•ˆç‚¹å‡»ï¼šå¢åŠ æ­¥æ•°ï¼Œç¿»è½¬å¡ç‰‡----------
                moves++;
                updateStats();

                // è·å–é…å¯¹IDï¼Œå°†å¡ç‰‡æ­£é¢æ˜¾ç¤ºä¸ºå¯¹åº”çš„å¯çˆ±å›¾æ¡ˆ
                const pairId = card.dataset.pairid;
                card.textContent = PAIR_EMOJIS[pairId];
                card.classList.add('flipped');

                // å­˜å…¥ç¿»è½¬æ•°ç»„
                flippedCards.push(card);

                // å¦‚æœæ°å¥½ç¿»å¼€äº†2å¼ å¡ç‰‡ï¼Œç«‹å³æ£€æŸ¥æ˜¯å¦é…å¯¹
                if (flippedCards.length === 2) {
                    checkMatch();
                }
            }

            // ---------- é‡ç½®/åˆå§‹åŒ–æ¸¸æˆæ¿ ----------
            function initBoard() {
                // 1. æ¸…ç†ä¹‹å‰çš„ä»»ä½•å¾…æ‰§è¡Œå®šæ—¶å™¨
                clearFlipTimeout();
                
                // 2. é‡ç½®çŠ¶æ€å˜é‡
                lockBoard = false;
                flippedCards = [];
                moves = 0;
                matchedPairs = 0;

                // 3. æ›´æ–°UIè®¡æ•°ã€æ¶ˆæ¯
                updateStats();
                resetMessage();

                // 4. ç”Ÿæˆæ–°çš„å¡ç‰‡é…å¯¹IDåºåˆ— (æ‰“ä¹±é¡ºåº)
                const pairIds = generateShuffledPairs();

                // 5. æ¸…ç©ºæ£‹ç›˜ï¼Œé‡æ–°æ„é€ å¡ç‰‡
                boardEl.innerHTML = '';

                // 6. æ ¹æ®pairIdsæ•°ç»„é€ä¸€åˆ›å»ºdivå¡ç‰‡
                pairIds.forEach((pairId, index) => {
                    const card = document.createElement('div');
                    card.className = 'card';                // åŸºç¡€å¡ç‰‡æ ·å¼
                    card.textContent = CARD_BACK;           // é»˜è®¤èƒŒé¢å°èŠ±èŠ±
                    card.dataset.pairid = pairId;           // å­˜å‚¨é…å¯¹ç»„ID (0~7)
                    card.dataset.index = index;             // ç´¢å¼•ï¼ˆå¤‡ç”¨ï¼‰
                    card.dataset.matched = 'false';         // åˆå§‹æœªåŒ¹é…

                    // æ·»åŠ ç‚¹å‡»ç›‘å¬
                    card.addEventListener('click', onCardClick);
                    boardEl.appendChild(card);
                });
            }

            // ---------- é‡ç½®æŒ‰é’®ç»‘å®š ----------
            function bindResetButton() {
                const resetBtn = document.getElementById('reset-button');
                resetBtn.addEventListener('click', function() {
                    // é‡ç½®ä¸€åˆ‡ï¼Œç„•æ–°å¼€å±€ï¼
                    initBoard();
                });
            }

            // ---------- é¡µé¢åŠ è½½ï¼Œå¯åŠ¨æ¸¸æˆ ----------
            window.addEventListener('DOMContentLoaded', function() {
                initBoard();
                bindResetButton();
            });
        })();
    </script>
</body>
</html>